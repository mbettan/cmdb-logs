2017-12-12 14:31:35,231  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2017-12-12 19:59:11,076  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2017-12-12 20:22:17,588  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2017-12-14 10:25:48,051  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2017-12-14 15:51:24,667  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-01-04 15:29:56,697  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-01-10 18:50:56,838  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 18:50:59,000  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 18:51:09,025  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@4546b49], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-10 18:51:11,842  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 18:51:19,040  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 18:51:26,836  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 18:51:34,066  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 18:51:41,846  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 18:51:44,082  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@4546b49], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-10 18:51:54,102  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 18:51:56,851  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 18:52:09,104  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 18:52:11,841  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 18:52:19,128  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@4546b49], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-10 21:31:41,985  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 21:31:44,242  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 21:31:54,263  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@4546b49], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-10 21:31:56,978  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 21:32:04,283  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 21:32:11,989  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 21:32:19,283  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 21:32:26,983  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 21:32:29,307  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@4546b49], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-10 21:32:39,333  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 21:32:41,980  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 21:32:54,330  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 21:32:56,978  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 21:33:04,345  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@4546b49], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-10 21:33:11,982  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 21:33:14,361  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 21:33:26,983  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 21:33:29,359  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 21:33:36,998  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@25827533], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-01-10 21:33:39,383  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@4546b49], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-10 21:33:47,018  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@25827533], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-01-10 21:33:49,401  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 21:33:57,038  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@31ae2f84], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-10 21:34:04,407  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@61aa800c], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-10 21:34:07,056  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@25827533], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-01-10 21:34:14,431  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@4546b49], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-12 14:57:19,005  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-01-12 18:12:28,920  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-01-12 18:34:34,791  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-01-15 18:18:16,967  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-01-25 10:43:03,471  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-01-29 23:22:43,505  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [-2147483648] undefined error code]
Failed on commit connection [70933e5b], due to exception org.postgresql.util.PSQLException: An I/O error occurred while sending to the backend.
	at com.mercury.topaz.cmdb.server.transaction.TransactionManager.commit(TransactionManager.java:97)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.commit(CmdbDalTransactionManager.java:22)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:122)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [-2147483648] undefined error code]
Failed on commit connection [70933e5b], due to exception org.postgresql.util.PSQLException: An I/O error occurred while sending to the backend.
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalConnection.commit(CmdbDalConnection.java:140)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.commit(CmdbDalTransaction.java:25)
	at com.mercury.topaz.cmdb.server.transaction.Transaction.commit(Transaction.java:93)
	at com.mercury.topaz.cmdb.server.transaction.TransactionManager.commit(TransactionManager.java:94)
	... 19 more
Caused by: org.postgresql.util.PSQLException: An I/O error occurred while sending to the backend.
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:315)
	at org.postgresql.jdbc.PgConnection.executeTransactionCommand(PgConnection.java:776)
	at org.postgresql.jdbc.PgConnection.commit(PgConnection.java:797)
	at org.apache.commons.dbcp2.DelegatingConnection.commit(DelegatingConnection.java:368)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalConnection.commit(CmdbDalConnection.java:132)
	... 22 more
Caused by: java.io.EOFException
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:282)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1916)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:288)
	... 26 more
2018-01-29 23:22:43,748  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-29 23:22:43,764  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:22:45,542  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:22:58,765  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:23:10,543  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:23:15,242  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-29 23:23:25,259  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:23:25,552  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:23:40,258  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:23:40,544  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:23:50,272  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-29 23:23:55,549  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:24:00,286  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:24:10,543  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:24:15,296  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:24:25,319  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-29 23:24:25,544  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:24:35,334  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:24:35,566  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@7155141f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-01-29 23:44:36,494  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:44:57,843  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:45:01,492  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:45:07,868  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-29 23:45:16,496  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:45:17,896  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:45:31,495  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:45:32,899  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:45:42,921  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-29 23:45:46,497  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:45:52,941  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-29 23:46:01,497  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-29 23:46:07,945  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-30 17:55:41,020  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-30 17:55:43,673  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-30 17:55:45,811  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-30 17:55:57,021  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-30 17:55:58,677  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-30 17:56:21,050  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-30 17:56:23,677  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-30 17:56:31,096  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-30 17:56:38,682  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-30 17:56:41,110  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-30 17:56:53,687  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-30 17:56:56,119  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-30 17:57:06,143  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-30 17:57:08,680  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-30 17:57:16,162  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-30 17:57:23,682  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-30 17:57:31,157  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-30 17:57:38,679  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-30 17:57:41,180  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-31 11:52:38,133  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [-2147483648] undefined error code]
Failed on commit connection [2463a75d], due to exception org.postgresql.util.PSQLException: An I/O error occurred while sending to the backend.
	at com.mercury.topaz.cmdb.server.transaction.TransactionManager.commit(TransactionManager.java:97)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.commit(CmdbDalTransactionManager.java:22)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:122)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [-2147483648] undefined error code]
Failed on commit connection [2463a75d], due to exception org.postgresql.util.PSQLException: An I/O error occurred while sending to the backend.
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalConnection.commit(CmdbDalConnection.java:140)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.commit(CmdbDalTransaction.java:25)
	at com.mercury.topaz.cmdb.server.transaction.Transaction.commit(Transaction.java:93)
	at com.mercury.topaz.cmdb.server.transaction.TransactionManager.commit(TransactionManager.java:94)
	... 19 more
Caused by: org.postgresql.util.PSQLException: An I/O error occurred while sending to the backend.
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:315)
	at org.postgresql.jdbc.PgConnection.executeTransactionCommand(PgConnection.java:776)
	at org.postgresql.jdbc.PgConnection.commit(PgConnection.java:797)
	at org.apache.commons.dbcp2.DelegatingConnection.commit(DelegatingConnection.java:368)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalConnection.commit(CmdbDalConnection.java:132)
	... 22 more
Caused by: java.io.EOFException
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:282)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1916)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:288)
	... 26 more
2018-01-31 11:52:39,116  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-31 11:52:39,118  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-31 11:52:39,131  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-31 11:53:04,119  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-31 11:53:04,134  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-31 11:53:19,114  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-31 11:53:19,125  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-31 11:53:29,122  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-31 11:53:34,124  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-31 11:53:44,128  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-31 11:53:49,124  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-31 11:53:54,142  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-31 11:54:04,120  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-31 11:54:04,151  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-31 11:54:19,119  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-01-31 11:54:19,161  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-01-31 11:54:29,131  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@7155141f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-01-31 11:54:29,176  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-01-31 11:54:39,141  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@7155141f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-01-31 11:54:39,184  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-01 14:26:43,819  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-01 14:26:52,654  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-01 14:26:58,930  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-01 14:26:58,938  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-01 14:26:58,943  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-01 14:27:14,856  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-01 14:27:23,957  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-01 14:27:29,848  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-01 14:27:38,946  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-01 14:27:44,855  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-01 14:27:48,956  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-01 14:27:59,846  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-01 14:28:03,963  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-01 14:28:13,982  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@3a38320d], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-01 14:28:14,857  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-01 14:28:23,988  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@4a9eec40], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-01 14:28:29,860  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3a282428], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor100.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-01 21:54:47,957  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-02-02 14:53:43,504  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 14:53:43,664  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 14:53:48,398  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-02 14:54:08,503  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 14:54:08,672  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 14:54:23,506  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 14:54:23,673  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 14:54:33,687  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-02 14:54:38,499  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 14:54:43,697  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 14:54:53,504  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 14:54:58,697  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 14:55:08,500  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 14:55:08,711  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-02 14:55:11,806  ERROR  [UCMDB - scheduler for customer 1, id name: Default Client] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.base.itc.schedule.LocalPeriodicTaskWrapper@7b74983f], details:
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4805aa8504234f5cb9ed3e990f98a714' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@5d5272bc' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4a3ba1648e1bfbf3a8ffb45e34220451' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@643f3a8d' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='44ce0d824363e3d8b1d5b21c90120074' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes@513a4749' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Tql Command: Scheduler Tql Condition Count Wake Up : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4ce55c3974a0a876a4eeedd80be63524' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.tql.operation.command.impl.TqlCommandConditionCountWakeUp@57af575a' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''}
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.createCmdbResponseOnCmdbError(RequestProcessor.java:499)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:223)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.handleRequest(RequestProcessor.java:127)
	at com.mercury.topaz.cmdb.server.manage.Framework.handleRequest(Framework.java:790)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeCMDBOperation(AbstractCmdbApi.java:38)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeOperation(AbstractCmdbApi.java:57)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeOperation(InternalApi.java:32)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeCMDBOperation(InternalApi.java:24)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:56)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:34)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.impl.AbstractPeriodicTask.execute(AbstractPeriodicTask.java:51)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.LocalPeriodicTaskWrapper.execute(LocalPeriodicTaskWrapper.java:25)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4805aa8504234f5cb9ed3e990f98a714' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@5d5272bc' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4a3ba1648e1bfbf3a8ffb45e34220451' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@643f3a8d' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='44ce0d824363e3d8b1d5b21c90120074' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes@513a4749' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Tql Command: Scheduler Tql Condition Count Wake Up
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:160)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequest(RequestProcessor.java:238)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequestWithQueueLimitation(RequestProcessor.java:247)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:201)
	... 18 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4805aa8504234f5cb9ed3e990f98a714' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@5d5272bc' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4a3ba1648e1bfbf3a8ffb45e34220451' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@643f3a8d' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='44ce0d824363e3d8b1d5b21c90120074' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes@513a4749' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Tql Command: Scheduler Tql Condition Count Wake Up
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:114)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:60)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.operation.flow.OperationInFlowDefaultExecutor.execute(OperationInFlowDefaultExecutor.java:23)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:158)
	... 21 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4805aa8504234f5cb9ed3e990f98a714' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@5d5272bc' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4a3ba1648e1bfbf3a8ffb45e34220451' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@643f3a8d' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='44ce0d824363e3d8b1d5b21c90120074' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes@513a4749' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''}
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.createCmdbResponseOnCmdbError(RequestProcessor.java:499)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:223)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.handleRequest(RequestProcessor.java:127)
	at com.mercury.topaz.cmdb.server.manage.Framework.handleRequest(Framework.java:790)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeCMDBOperation(AbstractCmdbApi.java:38)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeOperation(AbstractCmdbApi.java:57)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeOperation(InternalApi.java:32)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeCMDBOperation(InternalApi.java:24)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:56)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:34)
	at com.mercury.topaz.cmdb.server.tql.manager.impl.TqlConditionStatisticsManagerImpl.executeOperation(TqlConditionStatisticsManagerFactory.java:141)
	at com.mercury.topaz.cmdb.server.tql.manager.impl.TqlConditionStatisticsManagerImpl.updateTypeCounts(TqlConditionStatisticsManagerFactory.java:247)
	at com.mercury.topaz.cmdb.server.tql.operation.command.impl.TqlCommandConditionCountWakeUp.tqlExecute(TqlCommandConditionCountWakeUp.java:54)
	at com.mercury.topaz.cmdb.shared.tql.operation.impl.AbstractTqlOperation.doExecute(AbstractTqlOperation.java:46)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractFrameworkOperation.commonExecute(AbstractFrameworkOperation.java:17)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:87)
	... 25 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4805aa8504234f5cb9ed3e990f98a714' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@5d5272bc' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4a3ba1648e1bfbf3a8ffb45e34220451' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@643f3a8d' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:160)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequest(RequestProcessor.java:238)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequestWithQueueLimitation(RequestProcessor.java:247)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:201)
	... 39 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4805aa8504234f5cb9ed3e990f98a714' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@5d5272bc' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4a3ba1648e1bfbf3a8ffb45e34220451' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@643f3a8d' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:114)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:60)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.operation.flow.OperationInFlowDefaultExecutor.execute(OperationInFlowDefaultExecutor.java:23)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:158)
	... 42 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4805aa8504234f5cb9ed3e990f98a714' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@5d5272bc' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4a3ba1648e1bfbf3a8ffb45e34220451' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@643f3a8d' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''}
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.createCmdbResponseOnCmdbError(RequestProcessor.java:499)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:223)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.handleRequest(RequestProcessor.java:127)
	at com.mercury.topaz.cmdb.server.manage.Framework.handleRequest(Framework.java:790)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeCMDBOperation(AbstractCmdbApi.java:38)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeOperation(AbstractCmdbApi.java:57)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeOperation(InternalApi.java:32)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeCMDBOperation(InternalApi.java:24)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:56)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:34)
	at com.mercury.topaz.cmdb.server.manage.subsystem.AbstractCommonSubsystemManager.executeOperation(AbstractCommonSubsystemManager.java:82)
	at com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes.countTypes(ModelTopologyQueryGetCountByTypes.java:110)
	at com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes.doExecute(ModelTopologyQueryGetCountByTypes.java:88)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractFrameworkOperation.commonExecute(AbstractFrameworkOperation.java:17)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:87)
	... 46 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4805aa8504234f5cb9ed3e990f98a714' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@5d5272bc' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:160)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequest(RequestProcessor.java:238)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequestWithQueueLimitation(RequestProcessor.java:247)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:201)
	... 59 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4805aa8504234f5cb9ed3e990f98a714' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@5d5272bc' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:114)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:60)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.operation.flow.OperationInFlowDefaultExecutor.execute(OperationInFlowDefaultExecutor.java:23)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:158)
	... 62 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4805aa8504234f5cb9ed3e990f98a714' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@5d5272bc' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''}
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.createCmdbResponseOnCmdbError(RequestProcessor.java:499)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:223)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.handleRequest(RequestProcessor.java:127)
	at com.mercury.topaz.cmdb.server.manage.Framework.handleRequest(Framework.java:790)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeCMDBOperation(AbstractCmdbApi.java:38)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeOperation(AbstractCmdbApi.java:57)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeOperation(InternalApi.java:32)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeCMDBOperation(InternalApi.java:24)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:56)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:34)
	at com.mercury.topaz.cmdb.server.manage.subsystem.AbstractCommonSubsystemManager.executeOperation(AbstractCommonSubsystemManager.java:82)
	at com.mercury.topaz.cmdb.server.model.manager.impl.ModelQueryManagerImpl.countClassInstances(ModelQueryManagerFactory.java:192)
	at com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount.getObjectsCount(ModelQueryGetInstancesCount.java:80)
	at com.mercury.topaz.cmdb.server.model.operation.query.topology.AbstractModelTopologyQueryGetObjectsCount.doExecute(AbstractModelTopologyQueryGetObjectsCount.java:26)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractFrameworkOperation.commonExecute(AbstractFrameworkOperation.java:17)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:87)
	... 66 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:160)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequest(RequestProcessor.java:238)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequestWithQueueLimitation(RequestProcessor.java:247)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:201)
	... 80 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:114)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:60)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.operation.flow.OperationInFlowDefaultExecutor.execute(OperationInFlowDefaultExecutor.java:23)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:158)
	... 83 more
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.getConnection(DalAbstractCommand.java:122)
	at com.mercury.topaz.cmdb.server.dal.command.datamodel.impl.CmdbDalCountClassInstancesComplexCommand.retrieveForAllTenants(CmdbDalCountClassInstancesComplexCommand.java:122)
	at com.mercury.topaz.cmdb.server.dal.command.datamodel.impl.CmdbDalCountClassInstancesComplexCommand.perform(CmdbDalCountClassInstancesComplexCommand.java:81)
	at com.mercury.topaz.cmdb.server.dal.command.datamodel.impl.CmdbDalCountClassInstancesComplexCommand.perform(CmdbDalCountClassInstancesComplexCommand.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CmdbDalJdbcDataModelDAO.executeQuery(CmdbDalJdbcDataModelDAO.java:98)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CmdbDalJdbcDataModelDAO.countClassInstances(CmdbDalJdbcDataModelDAO.java:281)
	at com.mercury.topaz.cmdb.server.model.manager.impl.ModelTopologyManagerImpl.countClassInstances(ModelTopologyManagerImpl.java:495)
	at com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType.doExecute(ModelMemoryTopologyQueryGetCIsCountByType.java:34)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractFrameworkOperation.commonExecute(AbstractFrameworkOperation.java:17)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:87)
	... 87 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 109 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 110 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 124 more
2018-02-02 14:55:18,717  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 14:55:23,504  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 14:55:33,724  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 14:55:38,507  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 18:53:36,100  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 18:53:37,767  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-02 18:53:44,232  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 18:54:01,108  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 18:54:09,235  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 18:54:16,107  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 18:54:19,242  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-02 18:54:29,247  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 18:54:31,107  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 18:54:44,257  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 18:54:46,107  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 18:54:54,270  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-02 18:55:01,103  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 18:55:04,281  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 18:55:11,781  ERROR  [UCMDB - scheduler for customer 1, id name: Default Client] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.base.itc.schedule.LocalPeriodicTaskWrapper@7b74983f], details:
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4550ba3fdf95056ab6f1c0010a90b80b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@20e68212' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='43ffd2cd722cffea9028cb39346bd97b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@43ff101f' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4efae041f0a46607bc6d5972d58fe831' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes@6a0f9c1a' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Tql Command: Scheduler Tql Condition Count Wake Up : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4daf25dea651d014a4ad9dc5980d455d' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.tql.operation.command.impl.TqlCommandConditionCountWakeUp@30f4aed2' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''}
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.createCmdbResponseOnCmdbError(RequestProcessor.java:499)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:223)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.handleRequest(RequestProcessor.java:127)
	at com.mercury.topaz.cmdb.server.manage.Framework.handleRequest(Framework.java:790)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeCMDBOperation(AbstractCmdbApi.java:38)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeOperation(AbstractCmdbApi.java:57)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeOperation(InternalApi.java:32)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeCMDBOperation(InternalApi.java:24)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:56)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:34)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.impl.AbstractPeriodicTask.execute(AbstractPeriodicTask.java:51)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.LocalPeriodicTaskWrapper.execute(LocalPeriodicTaskWrapper.java:25)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4550ba3fdf95056ab6f1c0010a90b80b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@20e68212' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='43ffd2cd722cffea9028cb39346bd97b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@43ff101f' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4efae041f0a46607bc6d5972d58fe831' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes@6a0f9c1a' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Tql Command: Scheduler Tql Condition Count Wake Up
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:160)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequest(RequestProcessor.java:238)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequestWithQueueLimitation(RequestProcessor.java:247)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:201)
	... 18 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4550ba3fdf95056ab6f1c0010a90b80b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@20e68212' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='43ffd2cd722cffea9028cb39346bd97b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@43ff101f' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4efae041f0a46607bc6d5972d58fe831' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes@6a0f9c1a' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Tql Command: Scheduler Tql Condition Count Wake Up
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:114)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:60)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.operation.flow.OperationInFlowDefaultExecutor.execute(OperationInFlowDefaultExecutor.java:23)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:158)
	... 21 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4550ba3fdf95056ab6f1c0010a90b80b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@20e68212' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='43ffd2cd722cffea9028cb39346bd97b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@43ff101f' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4efae041f0a46607bc6d5972d58fe831' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes@6a0f9c1a' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''}
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.createCmdbResponseOnCmdbError(RequestProcessor.java:499)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:223)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.handleRequest(RequestProcessor.java:127)
	at com.mercury.topaz.cmdb.server.manage.Framework.handleRequest(Framework.java:790)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeCMDBOperation(AbstractCmdbApi.java:38)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeOperation(AbstractCmdbApi.java:57)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeOperation(InternalApi.java:32)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeCMDBOperation(InternalApi.java:24)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:56)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:34)
	at com.mercury.topaz.cmdb.server.tql.manager.impl.TqlConditionStatisticsManagerImpl.executeOperation(TqlConditionStatisticsManagerFactory.java:141)
	at com.mercury.topaz.cmdb.server.tql.manager.impl.TqlConditionStatisticsManagerImpl.updateTypeCounts(TqlConditionStatisticsManagerFactory.java:247)
	at com.mercury.topaz.cmdb.server.tql.operation.command.impl.TqlCommandConditionCountWakeUp.tqlExecute(TqlCommandConditionCountWakeUp.java:54)
	at com.mercury.topaz.cmdb.shared.tql.operation.impl.AbstractTqlOperation.doExecute(AbstractTqlOperation.java:46)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractFrameworkOperation.commonExecute(AbstractFrameworkOperation.java:17)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:87)
	... 25 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4550ba3fdf95056ab6f1c0010a90b80b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@20e68212' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='43ffd2cd722cffea9028cb39346bd97b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@43ff101f' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:160)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequest(RequestProcessor.java:238)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequestWithQueueLimitation(RequestProcessor.java:247)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:201)
	... 39 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4550ba3fdf95056ab6f1c0010a90b80b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@20e68212' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='43ffd2cd722cffea9028cb39346bd97b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@43ff101f' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:114)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:60)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.operation.flow.OperationInFlowDefaultExecutor.execute(OperationInFlowDefaultExecutor.java:23)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:158)
	... 42 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4550ba3fdf95056ab6f1c0010a90b80b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@20e68212' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='43ffd2cd722cffea9028cb39346bd97b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount@43ff101f' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''}
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.createCmdbResponseOnCmdbError(RequestProcessor.java:499)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:223)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.handleRequest(RequestProcessor.java:127)
	at com.mercury.topaz.cmdb.server.manage.Framework.handleRequest(Framework.java:790)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeCMDBOperation(AbstractCmdbApi.java:38)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeOperation(AbstractCmdbApi.java:57)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeOperation(InternalApi.java:32)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeCMDBOperation(InternalApi.java:24)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:56)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:34)
	at com.mercury.topaz.cmdb.server.manage.subsystem.AbstractCommonSubsystemManager.executeOperation(AbstractCommonSubsystemManager.java:82)
	at com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes.countTypes(ModelTopologyQueryGetCountByTypes.java:110)
	at com.mercury.topaz.cmdb.server.model.operation.query.topology.separation.ModelTopologyQueryGetCountByTypes.doExecute(ModelTopologyQueryGetCountByTypes.java:88)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractFrameworkOperation.commonExecute(AbstractFrameworkOperation.java:17)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:87)
	... 46 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4550ba3fdf95056ab6f1c0010a90b80b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@20e68212' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:160)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequest(RequestProcessor.java:238)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequestWithQueueLimitation(RequestProcessor.java:247)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:201)
	... 59 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class appilog.framework.shared.manage.impl.MamResponseException : appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4550ba3fdf95056ab6f1c0010a90b80b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@20e68212' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''} : operation Model Query: Get Instances Count for class: usage
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:114)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:60)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.operation.flow.OperationInFlowDefaultExecutor.execute(OperationInFlowDefaultExecutor.java:23)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:158)
	... 62 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation : class com.mercury.topaz.cmdb.shared.base.CmdbException : 
CMDB Internal Error: Error while handling request: {request: ID='4550ba3fdf95056ab6f1c0010a90b80b' Message='General CMDB request' Operation='com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType@20e68212' Customer ID='1, id name: Default Client' 
Context='CMDB Context: Customer id = '1, id name: Default Client' , User ID = '911' , Caller Application = 'Periodic task Tql_Statistics_Manager_Timer''}
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.createCmdbResponseOnCmdbError(RequestProcessor.java:499)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:223)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.handleRequest(RequestProcessor.java:127)
	at com.mercury.topaz.cmdb.server.manage.Framework.handleRequest(Framework.java:790)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeCMDBOperation(AbstractCmdbApi.java:38)
	at com.mercury.topaz.cmdb.client.manage.api.impl.AbstractCmdbApi.executeOperation(AbstractCmdbApi.java:57)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeOperation(InternalApi.java:32)
	at com.mercury.topaz.cmdb.client.manage.api.impl.InternalApi.executeCMDBOperation(InternalApi.java:24)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:56)
	at com.mercury.topaz.cmdb.server.manage.ServerApiFacade.executeOperation(ServerApiFacade.java:34)
	at com.mercury.topaz.cmdb.server.manage.subsystem.AbstractCommonSubsystemManager.executeOperation(AbstractCommonSubsystemManager.java:82)
	at com.mercury.topaz.cmdb.server.model.manager.impl.ModelQueryManagerImpl.countClassInstances(ModelQueryManagerFactory.java:192)
	at com.mercury.topaz.cmdb.server.model.operation.query.impl.ModelQueryGetInstancesCount.getObjectsCount(ModelQueryGetInstancesCount.java:80)
	at com.mercury.topaz.cmdb.server.model.operation.query.topology.AbstractModelTopologyQueryGetObjectsCount.doExecute(AbstractModelTopologyQueryGetObjectsCount.java:26)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractFrameworkOperation.commonExecute(AbstractFrameworkOperation.java:17)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:87)
	... 66 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [2] Couldn't connect to database]
appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:160)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequest(RequestProcessor.java:238)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.doProcessRequestWithQueueLimitation(RequestProcessor.java:247)
	at com.mercury.topaz.cmdb.server.manage.rpm.RequestProcessor.processRequest(RequestProcessor.java:201)
	... 80 more
Caused by: appilog.framework.shared.manage.impl.MamResponseException: [ErrorCode [2] Couldn't connect to database]
CMDB Operation Internal Error: class com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException : Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed. : operation Model Memory Topology Query : ModelMemoryTopologyQueryGetCIsCountByType - operation
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:114)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:60)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.operation.flow.OperationInFlowDefaultExecutor.execute(OperationInFlowDefaultExecutor.java:23)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation.execute(AbstractCommonOperation.java:158)
	... 83 more
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.getConnection(DalAbstractCommand.java:122)
	at com.mercury.topaz.cmdb.server.dal.command.datamodel.impl.CmdbDalCountClassInstancesComplexCommand.retrieveForAllTenants(CmdbDalCountClassInstancesComplexCommand.java:122)
	at com.mercury.topaz.cmdb.server.dal.command.datamodel.impl.CmdbDalCountClassInstancesComplexCommand.perform(CmdbDalCountClassInstancesComplexCommand.java:81)
	at com.mercury.topaz.cmdb.server.dal.command.datamodel.impl.CmdbDalCountClassInstancesComplexCommand.perform(CmdbDalCountClassInstancesComplexCommand.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CmdbDalJdbcDataModelDAO.executeQuery(CmdbDalJdbcDataModelDAO.java:98)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CmdbDalJdbcDataModelDAO.countClassInstances(CmdbDalJdbcDataModelDAO.java:281)
	at com.mercury.topaz.cmdb.server.model.manager.impl.ModelTopologyManagerImpl.countClassInstances(ModelTopologyManagerImpl.java:495)
	at com.mercury.topaz.cmdb.server.model.operation.query.topology.memory.ModelMemoryTopologyQueryGetCIsCountByType.doExecute(ModelMemoryTopologyQueryGetCIsCountByType.java:34)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractFrameworkOperation.commonExecute(AbstractFrameworkOperation.java:17)
	at com.mercury.topaz.cmdb.shared.manage.operation.impl.AbstractCommonOperation$OperationExecuteFlowTrackingCommand.execute(AbstractCommonOperation.java:87)
	... 87 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 109 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 110 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 124 more
2018-02-02 18:55:16,099  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 18:55:19,284  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 18:55:29,296  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-02 18:55:31,103  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 18:55:39,299  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 22:09:38,112  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 22:09:38,115  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 22:09:39,344  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-02 22:09:52,047  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 22:09:52,048  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 22:10:14,532  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 22:10:16,476  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 22:10:24,544  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-02 22:10:31,477  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 22:10:34,557  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 22:10:46,476  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 22:10:49,554  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 22:10:59,562  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-02 22:11:01,470  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 22:11:09,577  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 22:11:16,467  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 22:11:24,576  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-02 22:11:31,472  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-02 22:11:34,591  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-03 00:17:38,630  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-03 00:17:41,195  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-03 00:17:41,196  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-03 00:18:06,203  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-03 00:18:06,206  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-03 00:18:18,635  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-03 00:18:21,205  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-03 00:18:28,639  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-03 00:18:36,197  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-03 00:18:43,638  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-03 00:18:51,205  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-03 00:18:53,653  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-03 00:19:03,663  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-03 00:19:06,206  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-03 00:19:18,658  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-03 00:19:21,206  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-03 00:19:28,672  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-03 00:19:36,205  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-03 00:19:38,683  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-16 21:14:27,340  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-16 21:14:30,461  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-16 21:14:52,347  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-16 21:14:55,471  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-16 21:15:02,361  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-16 21:15:10,471  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-16 21:15:12,364  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-16 21:15:25,472  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-16 21:15:27,366  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-16 21:15:37,380  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-16 21:15:40,474  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-16 21:15:47,393  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-16 21:15:55,467  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-16 21:16:02,393  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-16 21:16:10,471  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-16 21:16:12,397  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-16 21:16:22,409  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-16 21:16:25,471  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-16 21:16:35,476  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@6f668841], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-16 21:16:37,407  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-16 21:16:45,489  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@6f668841], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-16 21:16:47,420  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-16 21:16:55,502  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-16 21:16:57,431  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-20 17:43:37,199  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-20 17:43:38,417  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-20 17:43:46,816  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-20 17:44:02,207  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-20 17:44:03,417  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-20 17:44:17,205  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-20 17:44:18,423  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-20 17:44:28,430  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-20 17:44:32,208  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-20 17:44:38,441  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-20 17:44:47,208  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-20 17:44:53,442  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-20 17:45:02,209  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-20 17:45:03,456  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-20 17:45:13,469  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-20 17:45:17,202  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-20 17:45:28,468  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-20 17:45:32,208  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-20 17:45:38,479  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-20 17:45:42,221  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@6f668841], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-20 17:45:48,492  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-20 17:45:52,224  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@6f668841], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-21 10:33:42,710  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 10:33:42,717  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 10:33:57,708  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 10:33:57,714  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 10:34:07,720  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-21 10:34:12,721  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 10:34:17,726  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 10:34:27,714  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 10:34:32,730  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 10:34:42,719  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 10:34:42,744  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-21 10:34:52,754  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 10:34:57,722  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 10:35:07,757  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 10:35:12,714  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 10:35:17,771  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-21 10:35:27,715  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 10:35:27,775  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 17:05:30,489  WARN   [qtp1607453282-104615] - Attempt to add periodic task has failed, as task already exists: api.request statistics
2018-02-21 22:32:25,939  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 22:32:25,998  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 22:32:50,943  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 22:32:50,999  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 22:33:00,958  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-21 22:33:06,008  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 22:33:10,970  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 22:33:21,008  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 22:33:25,971  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 22:33:35,986  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-21 22:33:36,006  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 22:33:45,998  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 22:33:51,008  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 22:34:00,991  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 22:34:06,008  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 22:34:11,005  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-21 22:34:21,008  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-21 22:34:21,011  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-21 22:34:31,023  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@6f668841], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-22 16:56:25,849  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-22 16:56:29,529  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-22 16:56:31,315  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-22 16:56:44,526  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-22 16:56:46,315  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-22 16:57:05,850  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-22 16:57:09,538  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-22 16:57:15,858  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-22 16:57:24,526  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-22 16:57:30,857  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-22 16:57:39,530  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-22 16:57:40,869  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-22 16:57:50,879  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-22 16:57:54,531  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-22 16:58:05,878  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-22 16:58:09,534  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-22 16:58:15,884  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-22 16:58:24,536  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-22 16:58:25,896  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-22 16:58:34,549  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@6f668841], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-22 16:58:40,897  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-22 16:58:44,554  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@6f668841], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-22 16:58:50,906  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-22 16:58:54,563  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-22 16:59:00,918  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-22 16:59:04,575  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@6f668841], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-22 16:59:14,588  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@6f668841], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-22 16:59:15,919  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@6a6b40ab], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor80.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-22 16:59:24,601  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@32beb602], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor101.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-22 16:59:25,923  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@287d6982], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-23 08:21:45,384  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-02-23 10:18:25,974  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-02-26 15:58:01,238  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
2018-02-26 16:15:45,452  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3fb74b7f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-26 16:15:46,080  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@412be67d], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor79.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: Connection to hcm-postgres-svc:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-26 16:16:07,461  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@583a6bb5], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-26 16:16:10,455  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3fb74b7f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-26 16:16:17,475  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@412be67d], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor79.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-26 16:16:25,454  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3fb74b7f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-26 16:16:32,477  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@412be67d], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor79.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-26 16:16:40,454  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3fb74b7f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-26 16:16:42,493  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@583a6bb5], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-26 16:16:52,500  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@412be67d], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor79.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-26 16:16:55,455  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3fb74b7f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-26 16:17:07,500  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@412be67d], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor79.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-26 16:17:10,454  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3fb74b7f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-26 16:17:17,511  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@583a6bb5], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-26 16:17:25,453  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3fb74b7f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-26 16:17:27,523  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@412be67d], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor79.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-26 16:17:40,455  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3fb74b7f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-26 16:17:42,515  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@412be67d], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor79.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-26 16:17:50,461  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@54fe62d2], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-26 16:17:52,523  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask@583a6bb5], details:
java.lang.NullPointerException
	at appilog.common.utils.content.install.ContentFileUtils.syncCPsBetweenFileSystemAndDatabase(ContentFileUtils.java:644)
	at com.hp.ucmdb.cp.CPFrameworkInitializer$SyncCPsFromFileSystemToDBTask.execute(CPFrameworkInitializer.java:81)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
2018-02-26 16:18:00,472  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask@54fe62d2], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.ha.impl.ServerNodeImpl$WriterHeartbeatTask.execute(ServerNodeImpl.java:277)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 29 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 33 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 34 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 48 more
2018-02-26 16:18:02,536  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@412be67d], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor79.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-26 16:18:10,484  ERROR  [HA Heartbeat scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask@3fb74b7f], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
SQL error executing unknown statement
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:632)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:565)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:551)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:510)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.HADaoImpl.testAndSetWriterServer(HADaoImpl.java:89)
	at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy244.testAndSetWriterServer(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.testAndSetWriterServer(Controller.java:332)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HATestAndSetWriterServerTask.execute(Controller.java:324)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.TransactionConnectionProvider.getConnection(TransactionConnectionProvider.java:13)
	at com.mercury.topaz.cmdb.server.manage.dal.jdbc_template.JDBCTemplate.executeQuery(JDBCTemplate.java:627)
	... 30 more
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 34 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 35 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 49 more
2018-02-26 16:18:17,538  ERROR  [UCMDB - global framework scheduler] - error occured during execution of periodic task [com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask@412be67d], details:
com.mercury.topaz.cmdb.server.manage.dal.CmdbDalException: [ErrorCode [2] Couldn't connect to database]
Error getting connection from pool, due to exception: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:540)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransaction.getConnection(CmdbDalTransaction.java:51)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalTransactionManager.getConnection(CmdbDalTransactionManager.java:27)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DalDaoSupport.getConnecton(DalDaoSupport.java:23)
	at com.mercury.topaz.cmdb.server.dal.dao.impl.CustomerDaoImpl.getAllCustomerRegistrations(CustomerDaoImpl.java:92)
	at sun.reflect.GeneratedMethodAccessor79.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy$ProxyDalAbstractCommand.perform(DaoFactory.java:155)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand$FlowControlDalCommandExecutor.execute(DalAbstractCommand.java:36)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:227)
	at com.mercury.topaz.cmdb.shared.manage.flowmanagement.api.FlowManager.execute(FlowManager.java:222)
	at com.mercury.topaz.cmdb.server.manage.dal.DalAbstractCommand.execute(DalAbstractCommand.java:54)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:120)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO$CmdbDalDeadlockRetriable.performAction(CmdbDalJdbcDAO.java:105)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.DefaultRetriableExecutorImpl.doExecute(DefaultRetriableExecutorImpl.java:37)
	at com.mercury.topaz.cmdb.shared.util.retry.impl.AbstractRetriableExecutor.execute(AbstractRetriableExecutor.java:37)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:61)
	at com.mercury.topaz.cmdb.server.manage.dal.CmdbDalJdbcDAO.executeQuery(CmdbDalJdbcDAO.java:53)
	at com.mercury.topaz.cmdb.server.manage.dal.dao.DaoFactory$TransactionProxy.invoke(DaoFactory.java:135)
	at com.sun.proxy.$Proxy242.getAllCustomerRegistrations(Unknown Source)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.getRegisteredCustomers(CustomerManager.java:157)
	at com.mercury.topaz.cmdb.server.manage.instance.CustomerManager.handleRegisteredCustomers(CustomerManager.java:128)
	at com.mercury.topaz.cmdb.server.manage.instance.Controller$HeartbeatTask.execute(Controller.java:308)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.doExecute(Scheduler.java:242)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.access$000(Scheduler.java:201)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:229)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper$1.executeInContext(Scheduler.java:226)
	at com.mercury.topaz.cmdb.shared.manage.AuthorizationContextUtils.executeInSystemAuthorizationContext(AuthorizationContextUtils.java:24)
	at com.mercury.topaz.cmdb.server.base.itc.schedule.Scheduler$TaskWrapper.run(Scheduler.java:226)
	at java.util.TimerThread.mainLoop(Timer.java:555)
	at java.util.TimerThread.run(Timer.java:505)
Caused by: com.mercury.topaz.cmdb.shared.base.CmdbException: [ErrorCode [-2147483648] undefined error code]
org.postgresql.util.PSQLException: The connection attempt failed.
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:491)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getTransactionalConnection(ConnectionPoolManager.java:534)
	... 31 more
Caused by: org.postgresql.util.PSQLException: The connection attempt failed.
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:272)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:52)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:216)
	at org.postgresql.Driver.makeConnection(Driver.java:404)
	at org.postgresql.Driver.connect(Driver.java:272)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.commons.dbcp2.DriverManagerConnectionFactory.createConnection(DriverManagerConnectionFactory.java:79)
	at com.mercury.topaz.cmdb.server.manage.dal.DataDirectConnectionFactory.createConnection(DataDirectConnectionFactory.java:30)
	at org.apache.commons.dbcp2.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:256)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:868)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager$ConnectionPoolDecorator.borrowObject(ConnectionPoolManager.java:767)
	at com.mercury.topaz.cmdb.server.manage.dal.ConnectionPoolManager.getNativeConnection(ConnectionPoolManager.java:479)
	... 32 more
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.postgresql.core.PGStream.<init>(PGStream.java:61)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:144)
	... 46 more
2018-02-26 16:41:24,772  WARN   [Controller] - Attempt to add periodic task has failed, as task already exists: urm statistics
